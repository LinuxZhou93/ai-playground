<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:xlink="http://www.w3.org/1999/xlink">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes">
<meta http-equiv="cache-control" content="no-cache">
<meta charset="utf-8">

<head>
    <title>Junior</title>
    <link href="css/base.css" rel="stylesheet">
    <link href="css/editor.css" rel="stylesheet">
    <link href="css/editorleftpanel.css" rel="stylesheet">
    <link href="css/editorstage.css" rel="stylesheet">
    <link href="css/editormodal.css" rel="stylesheet">
    <link href="css/librarymodal.css" rel="stylesheet">
    <link href="css/paintlook.css" rel="stylesheet">

    <script>
        window.scratchJrPage = 'editor';

        // POLYFILL: Mouse Events -> Touch Events for Desktop Support
        (function () {
            if ('ontouchstart' in window) return; // Touch device, do nothing

            // Mock Touch if missing (Desktop Chrome/Safari/Firefox)
            if (typeof window.Touch === 'undefined') {
                window.Touch = function (t) {
                    this.identifier = t.identifier;
                    this.target = t.target;
                    this.clientX = t.clientX;
                    this.clientY = t.clientY;
                    this.screenX = t.screenX;
                    this.screenY = t.screenY;
                    this.pageX = t.pageX;
                    this.pageY = t.pageY;
                };
            }

            // Mock TouchList if missing
            if (typeof window.TouchList === 'undefined') {
                window.TouchList = function (touches) {
                    this.length = touches.length;
                    for (let i = 0; i < this.length; i++) {
                        this[i] = touches[i];
                    }
                    this.item = function (index) { return this[index]; };
                };
            }

            // Mock TouchEvent if missing
            if (typeof window.TouchEvent === 'undefined') {
                window.TouchEvent = function (type, params) {
                    params = params || {};
                    const evt = document.createEvent('CustomEvent');
                    evt.initCustomEvent(type, params.bubbles, params.cancelable, null);
                    evt.touches = new TouchList(params.touches || []);
                    evt.targetTouches = new TouchList(params.targetTouches || []);
                    evt.changedTouches = new TouchList(params.changedTouches || []);
                    evt.view = params.view || window;
                    return evt;
                };
            }

            function dispatch(type, e) {
                if (e.button !== 0) return; // Only left click

                const touch = new Touch({
                    identifier: Date.now(),
                    target: e.target,
                    clientX: e.clientX,
                    clientY: e.clientY,
                    screenX: e.screenX,
                    screenY: e.screenY,
                    pageX: e.pageX,
                    pageY: e.pageY
                });

                const event = new TouchEvent(type, {
                    cancelable: true,
                    bubbles: true,
                    touches: (type === 'touchend') ? [] : [touch],
                    targetTouches: (type === 'touchend') ? [] : [touch],
                    changedTouches: [touch],
                    view: window
                });

                e.target.dispatchEvent(event);
            }

            let isDown = false;
            document.addEventListener('mousedown', (e) => { isDown = true; dispatch('touchstart', e); }, true);
            document.addEventListener('mousemove', (e) => {
                if (isDown) {
                    e.preventDefault();
                    dispatch('touchmove', e);
                }
            }, true);
            document.addEventListener('mouseup', (e) => {
                if (isDown) {
                    isDown = false;
                    dispatch('touchend', e);
                }
            }, true);
        })();
    </script>
    <script type="text/javascript" src="app.bundle.js"></script>
</head>

<body style="background: white;">
    <div class="frame" id="frame"></div>
    <div class="libframe" id="libframe"></div>
    <div class="paintframe" id="paintframe"></div>

</body>

</html>